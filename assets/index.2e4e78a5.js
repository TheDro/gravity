import{r as e,o as t,c as n,a as i,F as o,b as s,t as l,_ as a,w as r,d,e as u,l as p,f as m,v as c,g as f,h,i as v}from"./vendor.1c0f670c.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let y=1;function b(){return y++}const g={setup(){let t=e({height:200,width:200,points:[],minX:0,maxX:1,minY:0,maxY:1,scaleX:1,scaleY:1});return window.plot=function(e,n){t.minX=a.min(e),t.maxX=a.max(e),t.minY=a.min(n),t.maxY=a.max(n),t.scaleX=t.width/(t.maxX-t.minX),t.scaleY=t.height/(t.maxY-t.minY),t.points=[];for(let i=0;i<n.length;i++)t.points.push([e[i],n[i]]);console.log(t),window.plotState=t},{state:t}}},w=["width","height"],x=["transform"],U=["cx","cy"];function V(e){return Math.sqrt(e[0]**2+e[1]**2)}g.render=function(e,a,r,d,u,p){return t(),n(o,null,[(t(),n("svg",{width:d.state.width,height:d.state.height},[i("g",{transform:`scale(1 -1) translate(0 ${-d.state.height})`},[(t(!0),n(o,null,s(d.state.points,(e=>(t(),n("circle",{r:2,cx:(e[0]-d.state.minX)*d.state.scaleX,cy:(e[1]-d.state.minY)*d.state.scaleY,fill:"#333"},null,8,U)))),256))],8,x)],8,w)),i("div",null," x:["+l(d.state.minX)+", "+l(d.state.maxX)+"] ",1),i("div",null," y:["+l(d.state.minY)+", "+l(d.state.maxY)+"] ",1),i("div",null,"y/x: "+l(d.state.maxY/d.state.maxX),1)],64)};const k={props:{bodies:Array,dt:Number,nSteps:Number},components:{Plot:g},setup(t){let n=e({bodies:[],histories:[],paths:[],histories2:[],running:!1,logError:!1});r((()=>{n.paths=n.histories.map((e=>d(e.position,n.running?300:1e4)))})),r((()=>{n.bodies=a.cloneDeep(t.bodies)})),window.state=n,window._=a;let i=function(){let e={startTime:new Date,endTime:new Date,tik:function(){return e.startTime=new Date,e.startTime},tok:function(){return e.endTime=new Date,e.delta=e.endTime.valueOf()-e.startTime.valueOf(),e.delta},delta:0};return e}();function o(e,t=n.histories){e.forEach((e=>{e=a.cloneDeep(e);let n=a.find(t,{id:e.id});n||(n={id:e.id,position:[],v:[],a:[]},t.push(n)),n.position.push(e.position),n.v.push(e.v),n.a.push(e.a)}))}function s(e,r){if(!n.running)return;let d;i.tik();for(let i=0;i<t.nSteps;i++){let e=V(n.bodies[2].a),s=t.dt/t.nSteps,r=Math.min(5*s,Math.max(s/5,s/(100*e)**1));r=s,n.logError&&(d=a.cloneDeep(n.bodies),l(d,r/2),l(d,r/2),o(d,n.histories2)),l(n.bodies,r),i%4==0&&o(n.bodies,n.histories)}let u=Math.max(0,r-i.tok());setTimeout((()=>s(e,r)),u)}function l(e,t){e.forEach((n=>{if(n.fixed)return;let i=[0,0];e.forEach((e=>{if(e.id===n.id||0===e.mass)return;let o=e.id>n.id?.5:-.5,s=[e.position[0]+o*e.v[0]*t-(n.position[0]+.5*n.v[0]*t),e.position[1]+o*e.v[1]*t-(n.position[1]+.5*n.v[1]*t)],l=V(s),a=100*e.mass/l**2;i[0]+=a*s[0]/l,i[1]+=a*s[1]/l})),n.position[0]+=n.v[0]*t+.5*i[0]*t**2,n.position[1]+=n.v[1]*t+.5*i[1]*t**2,n.v[0]+=i[0]*t,n.v[1]+=i[1]*t,n.a=i}))}function d(e,t=1e4){if(e.length<1)return;let n=Math.max(e.length-t,0),i=`M ${e[n][0]} ${e[n][1]}`;for(n++;n<e.length;n++)i+=` L ${e[n][0]} ${e[n][1]}`;return i}return{state:n,toggle:function(){if(n.running=!n.running,n.running)s(1e3,1e3/60);else if(n.logError){let e={R:[],A:[]};for(let t=0;t<n.histories2[2].position.length;t++){let i=n.histories[2].position[t],o=n.histories2[2].position[t],s=n.histories2[2].a[t];n.histories[2][t],e.R.push(V([i[0]-o[0],i[1]-o[1]])),e.A.push(V(s))}window.delta=e,window.plot(e.A,e.R)}},reset:function(){n.bodies=a.cloneDeep(t.bodies),n.histories=[],n.histories2=[]},formatPathD:d}}},S={width:"600",height:"600",class:"shadow"},X=["transform"],Y=["d"],D=["r","cx","cy"];function C(e,t){let n=new URL(window.location.href);if(null==t)n.searchParams.delete(e);else if("string"==typeof t){let i=t;n.searchParams.set(e,i)}else{let i=p.stringify(t);n.searchParams.set(e,i)}window.history.replaceState(null,null,n)}k.render=function(e,a,r,p,m,c){const f=d("Plot");return t(),n(o,null,[i("div",null,[i("button",{onClick:a[0]||(a[0]=e=>p.toggle())},l(p.state.running?"Stop":"Start"),1),i("button",{onClick:a[1]||(a[1]=e=>p.reset())},"Reset")]),(t(),n("svg",S,[i("g",{transform:"scale(1 -1) translate(300 -300)"},[(t(!0),n(o,null,s(p.state.paths,(e=>(t(),n("g",null,[i("path",{d:e,"stroke-width":"1",stroke:"#333",fill:"none"},null,8,Y)])))),256)),(t(!0),n(o,null,s(p.state.bodies,(e=>(t(),n("g",null,[i("circle",{r:e.radius,cx:e.position[0],cy:e.position[1],fill:"orange"},null,8,D)])))),256))],8,X)])),u(f)],64)};window.json5=p;const E={components:{Simulator:k},setup(){let t=[{id:b(),mass:1,position:[0,0],v:[0,0],a:[0,0],radius:10,fixed:!0},{id:b(),mass:.02,position:[0,100],v:[1,0],a:[0,0],radius:5,fixed:!1},{id:b(),mass:.001,position:[0,250],v:[.6,0],a:[0,0],radius:3,fixed:!1}],n=e({bodies:t,dt:10,nSteps:10});function i(e,t){let n="number"==typeof e;if(!n&&void 0===t)throw`${e} is not a valid float`;return n?e:t}!function(){let e=function(e){let t=new URL(window.location.href).searchParams.get(e);if(null===t)return null;if(!(t.length>1)||"{"!==t[0]&&"["!==t[0])return t;try{return p.parse(t)}catch{return null}}("state");if(null===e)return;let t={},o=!0;try{t.dt=i(e.dt,n.dt),t.nSteps=function(e,t){let n="number"==typeof e;if(!n&&void 0===t)throw`${e} is not a valid integer`;return n?Math.round(e):t}(e.nSteps,n.nSteps),t.bodies=e.bodies.map((e=>function(e){return{id:b(),mass:i(e.mass,0),position:[i(e.position[0]),i(e.position[1])],v:[i(e.v[0]),i(e.v[1])],a:[0,0],radius:i(e.radius,5),fixed:e.fixed||!1}}(e)))}catch{o=!1}o?Object.assign(n,t):(console.error("state from URL was invalid"),C("state",null))}();let o={id:null,mass:0,position:[0,220],v:[.5,0],a:[0,0],radius:5,fixed:!1};return{state:n,addBody:function(){let e=a.cloneDeep(o);e.id=b(),n.bodies.push(e)},exportBodies:function(){C("state",a.cloneDeep(n)),function(e){const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}(window.href)},removeBody:function(e){a.remove(n.bodies,e)}}}},T=i("h1",null,"Gravity",-1),L={style:{display:"inline-block",margin:"0 0.5rem"}},M=i("label",null,"Time Step",-1),P={style:{display:"inline-block",margin:"0 0.5rem"}},A=i("label",null,"Subdivisions",-1),R={class:"scrolling-wrapper"},$={style:{display:"inline-block",width:"15rem"},class:"card"},B=i("label",null,"mass",-1),N=["onUpdate:modelValue"],O=i("label",null,"radius",-1),j={class:"flex-row"},q=["onUpdate:modelValue"],F=["onUpdate:modelValue"],G=i("label",null,"position",-1),I={class:"flex-row"},K=["onUpdate:modelValue"],_=["onUpdate:modelValue"],z={class:"flex-row"},H=["onUpdate:modelValue"],J=["onUpdate:modelValue"],Q=i("label",null,"velocity",-1),W={class:"flex-row"},Z=["onUpdate:modelValue"],ee=["onUpdate:modelValue"],te=i("label",null,"fixed",-1),ne=["onUpdate:modelValue"],ie={class:"flex-row"},oe=i("div",{style:{"flex-grow":"1"}},null,-1),se=["onClick"],le={style:{display:"inline-block","vertical-align":"top","padding-top":"1rem"}};E.render=function(e,l,a,r,p,h){const v=d("Simulator");return t(),n(o,null,[T,i("div",null,[i("div",L,[M,m(i("input",{type:"number","onUpdate:modelValue":l[0]||(l[0]=e=>r.state.dt=e),step:"any"},null,512),[[c,r.state.dt,void 0,{number:!0}]])]),i("div",P,[A,m(i("input",{type:"number","onUpdate:modelValue":l[1]||(l[1]=e=>r.state.nSteps=e),step:"any"},null,512),[[c,r.state.nSteps,void 0,{number:!0}]])]),i("button",{onClick:l[2]||(l[2]=e=>r.exportBodies())},"Export")]),i("div",R,[(t(!0),n(o,null,s(r.state.bodies,(e=>(t(),n("div",$,[B,m(i("input",{type:"number","onUpdate:modelValue":t=>e.mass=t,step:"any"},null,8,N),[[c,e.mass,void 0,{number:!0}]]),O,i("div",j,[m(i("input",{style:{"flex-grow":"1"},type:"range","onUpdate:modelValue":t=>e.radius=t,min:"0",max:"20",step:"0.1"},null,8,q),[[c,e.radius,void 0,{number:!0}]]),m(i("input",{style:{width:"4rem"},type:"number","onUpdate:modelValue":t=>e.radius=t,step:"0.1"},null,8,F),[[c,e.radius,void 0,{number:!0}]])]),G,i("div",I,[m(i("input",{style:{width:"50%"},type:"number","onUpdate:modelValue":t=>e.position[0]=t,step:"any"},null,8,K),[[c,e.position[0],void 0,{number:!0}]]),m(i("input",{style:{width:"50%"},type:"number","onUpdate:modelValue":t=>e.position[1]=t,step:"any"},null,8,_),[[c,e.position[1],void 0,{number:!0}]])]),i("div",z,[m(i("input",{style:{width:"50%"},type:"range","onUpdate:modelValue":t=>e.position[0]=t,min:"-300",max:"300",step:"1"},null,8,H),[[c,e.position[0],void 0,{number:!0}]]),m(i("input",{style:{width:"50%"},type:"range","onUpdate:modelValue":t=>e.position[1]=t,min:"-300",max:"300",step:"1"},null,8,J),[[c,e.position[1],void 0,{number:!0}]])]),Q,i("div",W,[m(i("input",{style:{width:"50%"},type:"number","onUpdate:modelValue":t=>e.v[0]=t,step:"any"},null,8,Z),[[c,e.v[0],void 0,{number:!0}]]),m(i("input",{style:{width:"50%"},type:"number","onUpdate:modelValue":t=>e.v[1]=t,step:"any"},null,8,ee),[[c,e.v[1],void 0,{number:!0}]])]),te,m(i("input",{type:"checkbox",style:{margin:"0.5rem"},"onUpdate:modelValue":t=>e.fixed=t},null,8,ne),[[f,e.fixed]]),i("div",ie,[oe,i("button",{onClick:t=>r.removeBody(e)},"remove",8,se)])])))),256)),i("div",le,[i("button",{onClick:l[3]||(l[3]=e=>r.addBody())},"Add")])]),u(v,{bodies:r.state.bodies,dt:r.state.dt,"n-steps":r.state.nSteps},null,8,["bodies","dt","n-steps"])],64)};v({setup:e=>(e,n)=>(t(),h(E))}).mount("#app");
