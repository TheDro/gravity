import{r as e,o as t,c as n,a as i,F as o,b as s,t as l,_ as a,m as r,d,e as u,w as p,s as c,f as m,g as f,h,l as b,i as y,v,j as g,k as w,n as x}from"./vendor.59b40046.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();let U=1;function V(){return U++}const S={setup(){let t=e({height:200,width:200,points:[],minX:0,maxX:1,minY:0,maxY:1,scaleX:1,scaleY:1});return window.plot=function(e,n){t.minX=a.min(e),t.maxX=a.max(e),t.minY=a.min(n),t.maxY=a.max(n),t.scaleX=t.width/(t.maxX-t.minX),t.scaleY=t.height/(t.maxY-t.minY),t.points=[];for(let i=0;i<n.length;i++)t.points.push([e[i],n[i]]);console.log(t),window.plotState=t},{state:t}}},k=["width","height"],C=["transform"],X=["cx","cy"];function Y(e){return Math.sqrt(d(e,e))}S.render=function(e,a,r,d,u,p){return t(),n(o,null,[(t(),n("svg",{width:d.state.width,height:d.state.height},[i("g",{transform:`scale(1 -1) translate(0 ${-d.state.height})`},[(t(!0),n(o,null,s(d.state.points,(e=>(t(),n("circle",{r:2,cx:(e[0]-d.state.minX)*d.state.scaleX,cy:(e[1]-d.state.minY)*d.state.scaleY,fill:"#333"},null,8,X)))),256))],8,C)],8,k)),i("div",null," x:["+l(d.state.minX)+", "+l(d.state.maxX)+"] ",1),i("div",null," y:["+l(d.state.minY)+", "+l(d.state.maxY)+"] ",1),i("div",null,"y/x: "+l(d.state.maxY/d.state.maxX),1)],64)},window.math=r;const D={props:{bodies:{type:Array,required:!0},histories:{type:Array,required:!0},last:{type:Number,default:1e4},relative:{type:Boolean,default:!1}},setup(t){let n=e({bodies:[],paths:[]});function i(e,t=1e4,n=null){if(e.length<1)return;let i,o=Math.max(e.length-t,0);if(n)for(i=`M ${e[o][0]-n[o][0]} ${e[o][1]-n[o][1]}`,o++;o<e.length;o++)i+=` L ${e[o][0]-n[o][0]} ${e[o][1]-n[o][1]}`;else for(i=`M ${e[o][0]} ${e[o][1]}`,o++;o<e.length;o++)i+=` L ${e[o][0]} ${e[o][1]}`;return i}return p((()=>{let e,o;t.relative&&(e=_.cloneDeep(_.find(t.bodies,{center:!0})),o=_.find(t.histories,{id:null==e?void 0:e.id})),n.bodies=_.cloneDeep(t.bodies).map((t=>(e&&(t.position=c(t.position,e.position)),t))),n.paths=t.histories.map((e=>o?i(e.position,t.last,o.position):i(e.position,t.last)))})),{state:n,props:t}}},$={width:"600",height:"600",class:"shadow"},E=["transform"],M=["d"],A=["r","cx","cy"];D.render=function(e,l,a,r,d,u){return t(),n("svg",$,[i("g",{transform:"scale(1 -1) translate(300 -300)"},[(t(!0),n(o,null,s(r.state.paths,(e=>(t(),n("g",null,[i("path",{d:e,"stroke-width":"1",stroke:"#333",fill:"none"},null,8,M)])))),256)),(t(!0),n(o,null,s(r.state.bodies,(e=>(t(),n("g",null,[i("circle",{r:e.radius,cx:e.position[0],cy:e.position[1],fill:"orange"},null,8,A)])))),256))],8,E)])};const L={props:{bodies:Array,dt:Number,nSteps:Number},components:{Plot:S,StarMap:D},setup(t){let n=e({bodies:[],histories:[],histories2:[],running:!1,logError:!1});p((()=>{n.bodies=a.cloneDeep(t.bodies)})),window.state=n,window._=a;let i=function(){let e={startTime:new Date,endTime:new Date,tik:function(){return e.startTime=new Date,e.startTime},tok:function(){return e.endTime=new Date,e.delta=e.endTime.valueOf()-e.startTime.valueOf(),e.delta},delta:0};return e}();function o(e,t=n.histories){e.forEach((e=>{e=a.cloneDeep(e);let n=a.find(t,{id:e.id});n||(n={id:e.id,position:[],v:[],a:[]},t.push(n)),n.position.push(e.position),n.v.push(e.v),n.a.push(e.a)}))}function s(e,r){if(!n.running)return;let d;i.tik();for(let i=0;i<t.nSteps;i++){let e=t.dt/t.nSteps;n.logError&&(d=a.cloneDeep(n.bodies),l(d,e/2),l(d,e/2),o(d,n.histories2)),l(n.bodies,e),i%Math.ceil(t.nSteps/2)==0&&o(n.bodies,n.histories)}let u=Math.max(0,r-i.tok());setTimeout((()=>s(e,r)),u)}function l(e,t){e.forEach((n=>{if(n.fixed)return;let i=[0,0];e.forEach((e=>{if(e.id===n.id||0===e.mass)return;let o=e.id>n.id?.5:-.5,s=c(h(e.position,u(o*t,e.v)),h(n.position,u(.5*t,n.v))),l=Y(s),a=100*e.mass/l**2;var r;i=h(i,u(a,u(r=s,1/Y(r))))})),n.position=h(n.position,h(u(n.v,t),u(i,.5*t**2))),n.v=h(n.v,u(t,i)),n.a=i}))}return{state:n,toggle:function(){if(n.running=!n.running,n.running)s(1e3,1e3/60);else if(n.logError){let e={R:[],A:[]};for(let t=0;t<n.histories2[2].position.length;t++){let i=n.histories[2].position[t],o=n.histories2[2].position[t],s=n.histories2[2].a[t];n.histories[2][t],e.R.push(Y([i[0]-o[0],i[1]-o[1]])),e.A.push(Y(s))}window.delta=e,window.plot(e.A,e.R)}},reset:function(){n.bodies=a.cloneDeep(t.bodies),n.histories=[],n.histories2=[]}}}};function T(e,t){let n=new URL(window.location.href);if(null==t)n.searchParams.delete(e);else if("string"==typeof t){let i=t;n.searchParams.set(e,i)}else{let i=b.stringify(t);n.searchParams.set(e,i)}window.history.replaceState(null,null,n)}L.render=function(e,s,a,r,d,u){const p=m("StarMap"),c=m("Plot");return t(),n(o,null,[i("div",null,[i("button",{onClick:s[0]||(s[0]=e=>r.toggle())},l(r.state.running?"Stop":"Start"),1),i("button",{onClick:s[1]||(s[1]=e=>r.reset())},"Reset")]),f(p,{bodies:r.state.bodies,histories:r.state.histories,last:r.state.running?200:1e4,relative:!1},null,8,["bodies","histories","last"]),f(p,{bodies:r.state.bodies,histories:r.state.histories,last:r.state.running?200:1e4,relative:!0},null,8,["bodies","histories","last"]),f(c)],64)};window.json5=b;const B={components:{Simulator:L},setup(){let t=[{id:V(),mass:1,position:[0,0],v:[0,0],a:[0,0],radius:10,fixed:!0,center:!1},{id:V(),mass:.02,position:[0,100],v:[1,0],a:[0,0],radius:5,fixed:!1,center:!1},{id:V(),mass:.001,position:[0,250],v:[.6,0],a:[0,0],radius:3,fixed:!1,center:!1}],n=e({bodies:t,dt:10,nSteps:10});function i(e,t){let n="number"==typeof e;if(!n&&void 0===t)throw`${e} is not a valid float`;return n?e:t}!function(){let e=function(e){let t=new URL(window.location.href).searchParams.get(e);if(null===t)return null;if(!(t.length>1)||"{"!==t[0]&&"["!==t[0])return t;try{return b.parse(t)}catch{return null}}("state");if(null===e)return;let t={},o=!0;try{t.dt=i(e.dt,n.dt),t.nSteps=function(e,t){let n="number"==typeof e;if(!n&&void 0===t)throw`${e} is not a valid integer`;return n?Math.round(e):t}(e.nSteps,n.nSteps),t.bodies=e.bodies.map((e=>function(e){return{id:V(),mass:i(e.mass,0),position:[i(e.position[0]),i(e.position[1])],v:[i(e.v[0]),i(e.v[1])],a:[0,0],radius:i(e.radius,5),fixed:e.fixed||!1,center:e.center||!1}}(e)))}catch{o=!1}o?Object.assign(n,t):(console.error("state from URL was invalid"),T("state",null))}();let o={id:null,mass:0,position:[0,220],v:[.5,0],a:[0,0],radius:5,fixed:!1,center:!1};return{state:n,addBody:function(){let e=a.cloneDeep(o);e.id=V(),n.bodies.push(e)},exportBodies:function(){T("state",a.cloneDeep(n)),function(e){const t=document.createElement("textarea");t.value=e,t.setAttribute("readonly",""),t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t)}(window.href)},removeBody:function(e){a.remove(n.bodies,e)},changeCenter:function(e){e.center&&n.bodies.forEach((t=>{t.id!==e.id&&(t.center=!1)}))}}}},P=i("h1",null,"Gravity",-1),R={style:{display:"inline-block",margin:"0 0.5rem"}},N=i("label",null,"Time Step",-1),j={style:{display:"inline-block",margin:"0 0.5rem"}},q=i("label",null,"Subdivisions",-1),O={class:"scrolling-wrapper"},F={style:{display:"inline-block",width:"15rem"},class:"card"},G=i("label",null,"mass",-1),I=["onUpdate:modelValue"],K=i("label",null,"radius",-1),z={class:"flex-row"},H=["onUpdate:modelValue"],J=["onUpdate:modelValue"],Q=i("label",null,"position",-1),W={class:"flex-row"},Z=["onUpdate:modelValue"],ee=["onUpdate:modelValue"],te={class:"flex-row"},ne=["onUpdate:modelValue"],ie=["onUpdate:modelValue"],oe=i("label",null,"velocity",-1),se={class:"flex-row"},le=["onUpdate:modelValue"],ae=["onUpdate:modelValue"],re=i("label",null,"fixed",-1),de=["onUpdate:modelValue"],ue=i("label",null,"center",-1),pe=["onUpdate:modelValue","onChange"],ce={class:"flex-row"},me=i("div",{style:{"flex-grow":"1"}},null,-1),fe=["onClick"],he={style:{display:"inline-block","vertical-align":"top","padding-top":"1rem"}};B.render=function(e,l,a,r,d,u){const p=m("Simulator");return t(),n(o,null,[P,i("div",null,[i("div",R,[N,y(i("input",{type:"number","onUpdate:modelValue":l[0]||(l[0]=e=>r.state.dt=e),step:"any"},null,512),[[v,r.state.dt,void 0,{number:!0}]])]),i("div",j,[q,y(i("input",{type:"number","onUpdate:modelValue":l[1]||(l[1]=e=>r.state.nSteps=e),step:"any"},null,512),[[v,r.state.nSteps,void 0,{number:!0}]])]),i("button",{onClick:l[2]||(l[2]=e=>r.exportBodies())},"Export")]),i("div",O,[(t(!0),n(o,null,s(r.state.bodies,(e=>(t(),n("div",F,[G,y(i("input",{type:"number","onUpdate:modelValue":t=>e.mass=t,step:"any"},null,8,I),[[v,e.mass,void 0,{number:!0}]]),K,i("div",z,[y(i("input",{style:{"flex-grow":"1"},type:"range","onUpdate:modelValue":t=>e.radius=t,min:"0",max:"20",step:"0.1"},null,8,H),[[v,e.radius,void 0,{number:!0}]]),y(i("input",{style:{width:"4rem"},type:"number","onUpdate:modelValue":t=>e.radius=t,step:"0.1"},null,8,J),[[v,e.radius,void 0,{number:!0}]])]),Q,i("div",W,[y(i("input",{style:{width:"50%"},type:"number","onUpdate:modelValue":t=>e.position[0]=t,step:"any"},null,8,Z),[[v,e.position[0],void 0,{number:!0}]]),y(i("input",{style:{width:"50%"},type:"number","onUpdate:modelValue":t=>e.position[1]=t,step:"any"},null,8,ee),[[v,e.position[1],void 0,{number:!0}]])]),i("div",te,[y(i("input",{style:{width:"50%"},type:"range","onUpdate:modelValue":t=>e.position[0]=t,min:"-300",max:"300",step:"1"},null,8,ne),[[v,e.position[0],void 0,{number:!0}]]),y(i("input",{style:{width:"50%"},type:"range","onUpdate:modelValue":t=>e.position[1]=t,min:"-300",max:"300",step:"1"},null,8,ie),[[v,e.position[1],void 0,{number:!0}]])]),oe,i("div",se,[y(i("input",{style:{width:"50%"},type:"number","onUpdate:modelValue":t=>e.v[0]=t,step:"any"},null,8,le),[[v,e.v[0],void 0,{number:!0}]]),y(i("input",{style:{width:"50%"},type:"number","onUpdate:modelValue":t=>e.v[1]=t,step:"any"},null,8,ae),[[v,e.v[1],void 0,{number:!0}]])]),re,y(i("input",{type:"checkbox",style:{margin:"0.5rem"},"onUpdate:modelValue":t=>e.fixed=t},null,8,de),[[g,e.fixed]]),ue,y(i("input",{type:"checkbox",style:{margin:"0.5rem"},"onUpdate:modelValue":t=>e.center=t,onChange:t=>r.changeCenter(e)},null,40,pe),[[g,e.center]]),i("div",ce,[me,i("button",{onClick:t=>r.removeBody(e)},"remove",8,fe)])])))),256)),i("div",he,[i("button",{onClick:l[3]||(l[3]=e=>r.addBody())},"Add")])]),f(p,{bodies:r.state.bodies,dt:r.state.dt,"n-steps":r.state.nSteps},null,8,["bodies","dt","n-steps"])],64)};x({setup:e=>(e,n)=>(t(),w(B))}).mount("#app");
